import{createClient as p}from"https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function s(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(e){if(e.ep)return;e.ep=!0;const t=s(e);fetch(e.href,t)}})();const v="https://dbhjxlepxehsfdsbvbul.supabase.co",y="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRiaGp4bGVweGVoc2Zkc2J2YnVsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkzMDM0MTcsImV4cCI6MjA4NDg3OTQxN30.JN5dL_mzP4NQTSvj-A2C-ZhP8hT1iZcwhgRPqcZw46Y",l=p(v,y),g=document.getElementById("importForm"),f=document.getElementById("status"),d=document.getElementById("submitBtn"),a=document.getElementById("videosList");async function u(){try{const{data:i,error:r}=await l.from("reels").select("*").order("sort_order",{ascending:!1}).order("created_at",{ascending:!1});if(r)throw r;if(!i||i.length===0){a.innerHTML='<div class="empty-state">Пока нет видео. Добавьте первое!</div>';return}a.innerHTML=i.map((s,o)=>`
          <div class="video-item">
            <div class="video-info">
              <div class="video-title">${s.title}</div>
              <div class="video-url">${s.video_url}</div>
              ${s.description?`<div style="font-size: 12px; color: #999; margin-top: 5px;">${s.description}</div>`:""}
            </div>
            <button class="delete-btn" onclick="deleteVideo('${s.id}')">Удалить</button>
          </div>
        `).join("")}catch(i){console.error("Ошибка загрузки видео:",i),a.innerHTML='<div class="empty-state">Ошибка загрузки видео</div>'}}window.deleteVideo=async function(i){if(confirm("Удалить это видео?"))try{const{error:r}=await l.from("reels").delete().eq("id",i);if(r)throw r;c("Видео удалено","success"),await u()}catch(r){c("Ошибка удаления: "+r.message,"error")}};g.addEventListener("submit",async i=>{i.preventDefault();const r=document.getElementById("title").value.trim(),s=document.getElementById("videoUrl").value.trim(),o=document.getElementById("description").value.trim(),e=document.getElementById("thumbnailUrl").value.trim();if(!r||!s){c("Заполните обязательные поля","error");return}d.disabled=!0,d.textContent="Добавляю...";try{const{data:t}=await l.from("reels").select("sort_order").order("sort_order",{ascending:!1}).limit(1),n=t&&t.length>0?t[0].sort_order+1:1,{error:m}=await l.from("reels").insert({title:r,video_url:s,description:o||"",thumbnail_url:e||"",sort_order:n,is_published:!0});if(m)throw m;c("✅ Видео успешно добавлено!","success"),document.getElementById("title").value="",document.getElementById("videoUrl").value="",document.getElementById("description").value="",document.getElementById("thumbnailUrl").value="",await u()}catch(t){c("Ошибка: "+t.message,"error")}finally{d.disabled=!1,d.textContent="Добавить видео"}});function c(i,r){f.textContent=i,f.className="status "+r}u();
